# 解释原理说明

**深度开发**中通过make工具链将脚本文件解释到`./code/FlowData.cs`文件，**低代码开发**则依赖`./code/Global.cs`文件对`./script`文件夹内的脚本演出脚本即时读取。剧本演出脚本解析为json格式后在`./scene/game.tscn`进行统一调用。

## 解析到json

解析过程`./code/Global.cs`与make工具链的实现为同源的，核心解析工具均为`read_file()`函数，核心实现功能如下：
### 文件逐行处理

通过读取文件，对文件进行逐行读取，各行`string line`限制不为null，删除字符串的头尾空白符

### 大括号处理

当存在左括号`{`存在时当前行`string line`将持续添加下一行信息直到右括号闭合`}`，大括号内信息使用`set_braces_func1()`函数统一处理

### 选项处理

当读取`[选项]`时存储`flow_line.type="选项"`，跳转为其他类型前将每行`line`作为一个选项存储于`set_option`


## json处理逻辑

### 文字处理

文字处理工作需要提前设置`type="对话框"`或`type="全屏"`，对话将根据type类型将文字显示在对应窗口中。
- 图片功能集合：可以在文字处理中同时加入图片功能，图片将在文字处理的当前行更新。
- 声音功能集合：可以在文字处理中同时加入声音功能，声音将在文字处理的当前行更新。
- 跳转功能集合：可以在文字处理中同时加入跳转功能，跳转会在文字处理完的下一行跳转到新的场景。

### 图片处理

当图片变换需要作为单独的点击元素存在时需要单独设置`type=“图片”`，便于
